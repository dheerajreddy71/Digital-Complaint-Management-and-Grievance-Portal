# Digital Complaint Management & Grievance Portal

A full-stack web application for registering complaints, tracking status, and providing feedback with admin assignment and analytics.

## Tech Stack

| Layer          | Technology                    | Version  |
| -------------- | ----------------------------- | -------- |
| Frontend       | Angular                       | 16.x     |
| UI Components  | Angular Material              | 16.x     |
| Backend        | Node.js + Express             | 18.x LTS |
| Language       | TypeScript                    | 5.x      |
| Database       | MySQL                         | 8.x      |
| Authentication | JWT (Access + Refresh Tokens) | -        |
| File Storage   | Local Server                  | -        |

## Project Structure

```
├── backend/                 # Node.js + Express API
│   ├── src/
│   │   ├── controllers/     # Route handlers
│   │   ├── services/        # Business logic
│   │   ├── repositories/    # Database queries
│   │   ├── middlewares/     # Auth, rate limiting, etc.
│   │   ├── models/          # TypeScript interfaces
│   │   ├── utils/           # Helpers, validators
│   │   ├── jobs/            # Scheduled tasks (SLA checks)
│   │   └── config/          # Environment configs
│   ├── uploads/             # File storage
│   └── tests/               # Unit & integration tests
├── frontend/                # Angular 16 SPA
│   └── src/
│       ├── app/
│       │   ├── components/  # UI components
│       │   ├── services/    # API services
│       │   ├── guards/      # Route guards
│       │   ├── interceptors/# HTTP interceptors
│       │   └── models/      # TypeScript interfaces
│       └── assets/          # Static files
└── docs/                    # Documentation
```

## Prerequisites

- Node.js 18.x LTS
- MySQL 8.x
- Angular CLI 16.x (`npm install -g @angular/cli@16`)

## Local Setup

### 1. Clone & Install Dependencies

```bash
# Backend
cd backend
pnpm install

# Frontend
cd frontend
pnpm install
```

### 2. Configure Environment

Create `backend/.env`:

```env
NODE_ENV=development
PORT=3000
DB_HOST=localhost
DB_PORT=3306
DB_USER=root
DB_PASSWORD=your_password
DB_NAME=complaint_portal
JWT_SECRET=your-super-secret-key-change-in-production
JWT_REFRESH_SECRET=your-refresh-secret-key-change-in-production
JWT_EXPIRES_IN=30m
JWT_REFRESH_EXPIRES_IN=7d
UPLOAD_MAX_SIZE=5242880
```

### 3. Setup Database

```bash
# Create database and run migrations
cd backend
pnpm run db:setup
pnpm run db:seed  # Optional: seed with sample data
```

### 4. Run Development Servers

```bash 
# Terminal 1 - Backend (runs on http://localhost:3000)
cd backend
pnpm run dev

# Terminal 2 - Frontend (runs on http://localhost:4200)
cd frontend
pnpm start
```

## Build & Production

### Backend

```bash
cd backend
pnpm run build
pnpm start
```

### Frontend

```bash
cd frontend
pnpm run build
```

### Docker

```bash
docker-compose up -d
```

## Test Commands

```bash
# Backend tests
cd backend
pnpm test                  # Run all tests
pnpm run test:coverage     # With coverage report

# Frontend tests
cd frontend
pnpm test                  # Unit tests
pnpm run e2e               # E2E tests
```

## API Documentation

See [docs/api-routes.md](docs/api-routes.md) for complete API reference.

### Quick API Examples

```bash
# Register user
curl -X POST http://localhost:3000/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{"name":"John Doe","email":"john@example.com","password":"Pass123!","role":"User"}'

# Login
curl -X POST http://localhost:3000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"john@example.com","password":"Pass123!"}'

# Create complaint (with token)
curl -X POST http://localhost:3000/api/complaints \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer <access_token>" \
  -d '{"title":"Broken AC","description":"AC not cooling","category":"Facility","priority":"High","location":"Room 101"}'
```

## Seed Credentials

| Role  | Email            | Password  |
| ----- | ---------------- | --------- |
| Admin | admin@portal.com | Admin123! |
| Staff | staff@portal.com | Staff123! |
| User  | user@portal.com  | User123!  |

## Features

### Phase 1: Core

- ✅ User registration with role selection
- ✅ JWT authentication with refresh tokens
- ✅ Complaint CRUD operations
- ✅ Status lifecycle (Open → Assigned → In-progress → Resolved)
- ✅ Priority & SLA management
- ✅ In-app notifications
- ✅ Feedback & rating system

### Phase 2: User Experience

- ✅ Complaint timeline/history
- ✅ Advanced search, filter, sort
- ✅ Attachment management with preview
- ✅ Dark/Light mode toggle
- ✅ Mobile-responsive design
- ✅ Analytics dashboard

### Phase 3: Intelligence

- ✅ Auto-assignment logic
- ✅ AI category suggestions (keyword-based)
- ✅ Recurring complaint detection
- ✅ Escalation system
- ✅ Duplication detection

### Phase 4: Advanced

- ✅ Staff workload management
- ✅ Bulk operations
- ✅ Commenting system
- ✅ Audit logging
- ✅ Export functionality

## Responsive Breakpoints

| Breakpoint     | Width      |
| -------------- | ---------- |
| Mobile         | ≤ 480px    |
| Small Tablet   | 481–768px  |
| Tablet/Desktop | 769–1200px |
| Large Desktop  | > 1200px   |

## License

MIT
